\documentclass[a4paper]{report}

\usepackage[T1]{fontenc}

\usepackage[margin=3.5cm, includeheadfoot]{geometry}
\usepackage{adjustbox}

\usepackage[scale=0.85]{sourcecodepro}

\usepackage{tikz}
\usetikzlibrary{positioning,fit}

\usepackage{booktabs}
\usepackage{listings}

\usepackage[backend=biber]{biblatex}

\addbibresource{resources.bib}

\lstset{%
	language=Eiffel,
	basicstyle=\ttfamily,
	keywordstyle=\color{blue},
	showstringspaces=false, tabsize=4,
	deletekeywords={},
	morekeywords={%
		True, False,
		MANAGED_POINTER, FILE
		TAR_HEADER, TAR_CONST, ARCHIVE,
		FILE_STORAGE_BACKEND, STORAGE_BACKEND,
		ARCHIVABLE, FILE_ARCHIVABLE, DIRECTORY_ARCHIVABLE,
		UNARCHIVER, FILE_UNARCHIVER, DIRECTORY_UNARCHIVER
	},
}

\begin{document}

\chapter{Overview}
The etar library provides support for archiving data using the pax/tar format.

\section{Concepts}
\subsection{Archive}
An archive is a series of blocks of size 512 bytes. An entry consists of exactly
one header block, followed by zero or more payload blocks. At the end of the
archive there are two consecutive blocks with all zero bytes.

\begin{figure}[h]
	\begin{center}
		\input{figures/archive.tikz}
	\end{center}
	\caption{Structure of an archive}
\end{figure}

\section{Error Handling}
API still unstable

\include{parts/archive}
\include{parts/tar_header}
\include{parts/storage_backend}
\include{parts/archivable}

\chapter{UNARCHIVER}
\lstinline;UNARCHIVE; is the central piece for unarchiving. \lstinline;ARCHIVE;
will parse the header and search for the last registered (!)
\lstinline;UNARCHIVER; that can unarchive the payload that belongs to the
header. This \lstinline;UNARCHIVER; will then be initialized with the header
and be passed blocks until it indicates that unarchiving finished.

etar provides two predefined \lstinline;UNARCHIVER;s

\section{FILE\_UNARCHIVER}
\lstinline;FILE\_UNARCHIVER; accepts all headers that have a typeflag for a
regular file ('0' and '\%U'). It will create a \lstinline;RAW_FILE; and copy all
payload blocks to it until \lstinline;size; bytes are written (indicated by the
header). Additionally it will try to set the metadata according to the header.

\section{DIRECTORY\_UNARCHIVER}
\lstinline;DIRECTORY\_UNARCHIVER; accepts all headers that have the directory
typeflag ('5'). It will create a new directory and try to set the metadata
according to the header.

\section{Implementing a Custom UNARCHIVER}

\printbibliography[heading=bibintoc]

\end{document}
